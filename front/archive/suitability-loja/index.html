<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SuitAbility Loja</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
  body {
    margin: 0;
    font-family: 'Inter', sans-serif;
    background: #fff;
    color: #111827;
    display: flex;
    flex-direction: column;
    height: 100vh;
  }

  header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px;
  }

  header button {
    border: none;
    width: 36px;
    height: 36px;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 18px;
    cursor: pointer;
  }

  #btn-back { background: #ffffff; color: #000000; }
  #btn-menu { background: #000000; color: #ffffff; }

  main {
    flex: 1;
    display: flex;
    flex-direction: column;
    padding: 30px;
    overflow-y: auto;
    justify-content: space-between;
  }

  .content-wrapper {
    width: 100%;
    max-width: 600px;
    display: flex;
    flex-direction: column;
    align-items: stretch;
    flex: 1;
  }

  h1 { font-size: 22px; font-weight: 800; margin: 0 0 8px 0; text-align: left; }
  h2 { font-size: 14px; font-weight: 100; margin: 0 0 20px 0; text-align: left; }

  .number-respondidos {
    background-color: #F1F5F9;
    font-size: 14px;
    border-radius: 100px;
    font-weight: 700;
    display: inline-block;
    padding: 4px 12px; 
    text-align: center;
    margin: 8px 0 20px 0;
    width: fit-content;
  }

  .radio-list {
    list-style: none;
    padding: 0;
    margin: 0 0 20px 0;
    width: 100%;
    border-radius: 12px;
    overflow: hidden;
    display: flex;
    flex-direction: column;
  }

  .radio-list li {
    display: flex;
    align-items: center;
    padding: 12px 0;
    border-bottom: 1px solid #e5e7eb;
    font-size: 14px;
  }

  .radio-list li:last-child {
    border-bottom: none;
  }

  .radio-input {
    appearance: none;
    -webkit-appearance: none;
    width: 28px;
    height: 28px;
    border: 2px solid #6b7280;
    border-radius: 50%;
    margin-right: 12px;
    position: relative;
    cursor: pointer;
    flex-shrink: 0;
  }

  .radio-input:checked::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 14px;
    height: 14px;
    background: #111827;
    border-radius: 50%;
  }

  .radio-label { cursor: pointer; }

  .button-wrapper {
    display: flex;
    justify-content: space-between;
  }

  .btn-continuar, .btn-voltar-questao {
    padding: 12px 24px;
    background-color: #111827;
    color: #ffffff;
    border: none;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
  }

  .btn-continuar:disabled {
    background-color: #9ca3af;
    cursor: not-allowed;
  }

  .btn-voltar-questao {
    background-color: #6b7280;
  }

  .btn-continuar:hover:enabled { background-color: #333; }
  .btn-voltar-questao:hover { background-color: #4b5563; }
</style>
</head>
<body>
<header>
  <button id="btn-back" onclick="back()">&larr;</button>
  <button id="btn-menu">&#9776;</button>
</header>

<main>
  <div class="content-wrapper">
    <div>
      <h1 class="suitability-title">SuitAbility Loja</h1>
      <h2 id="question-text"></h2>
      <p class="number-respondidos" id="question-tag"></p>

      <ul class="radio-list" id="options-list"></ul>
    </div>

    <div class="button-wrapper">
      <button class="btn-voltar-questao" id="btn-back-question" style="display:none;">Voltar</button>
      <button class="btn-continuar" id="btn-continuar" disabled>Continuar</button>
    </div>
  </div>
</main>

<script>
let questions = [];
let currentQuestion = 0;

const questionText = document.getElementById('question-text');
const questionTag = document.getElementById('question-tag');
const optionsList = document.getElementById('options-list');
const btnContinuar = document.getElementById('btn-continuar');
const btnBackQuestion = document.getElementById('btn-back-question');

async function loadQuestions() {
  try {
    const response = await fetch('perguntas_suitability.json');
    questions = await response.json();
    renderQuestion();
  } catch(err) {
    console.error('Erro ao carregar perguntas:', err);
  }
}

function renderQuestion() {
  const q = questions[currentQuestion];
  questionText.textContent = q.question;
  questionTag.textContent = q.tag;

  optionsList.innerHTML = '';
  btnContinuar.disabled = true;

  q.options.forEach((opt, index) => {
    const li = document.createElement('li');

    const input = document.createElement('input');
    input.type = 'radio';
    input.name = 'intensidade';
    input.id = `option-${currentQuestion}-${index}`;
    input.className = 'radio-input';
    if(opt.isFilled) input.checked = true;

    input.addEventListener('change', () => {
      q.options.forEach(o => o.isFilled = false);
      opt.isFilled = true;
      btnContinuar.disabled = false; // habilita botão ao marcar
    });

    const label = document.createElement('label');
    label.htmlFor = input.id;
    label.className = 'radio-label';
    label.textContent = opt.name;

    li.appendChild(input);
    li.appendChild(label);
    optionsList.appendChild(li);
  });

  // se já tiver resposta marcada, habilita o botão
  if(q.options.some(o => o.isFilled)) btnContinuar.disabled = false;

  btnBackQuestion.style.display = currentQuestion > 0 ? 'inline-flex' : 'none';
  btnContinuar.textContent = q.isLast ? 'Enviar' : 'Continuar';
}

btnContinuar.addEventListener('click', () => {
  if(currentQuestion < questions.length - 1){
    currentQuestion++;
    renderQuestion();
  } else {
    const respostas = questions.map(q => ({
      question: q.question,
      selected: q.options.find(o => o.isFilled)?.name || null
    }));

    window.location.href = "../cicle-create/index.html";
  }
});

btnBackQuestion.addEventListener('click', () => {
  if(currentQuestion > 0){
    currentQuestion--;
    renderQuestion();
  }
});

function back() {
  history.back()
}

loadQuestions();
</script>
</body>
</html>
